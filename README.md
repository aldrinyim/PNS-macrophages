# PNS-macrophages

## System requirement
The code has been implemented and tested on both MacOS 10.15.3 and Ubuntu/Linux 4.15.0-46-generic kernel.

For R codes, the following library version were tested:\
R 3.4.3\
Seurat 2.2.0\
ggplot2 3.2.1\
cowplot 1.0.0\
Matrix 1.2-18\
monocle 2.9.0\
edgeR 3.20.9\
limma 3.34.9

For Python, the following version has been tested:\
Python 3.6.5 & 3.7.5

Libraries required by the Python code:\
pysam\
pandas\
seaborn\
matplotlib\
numpy\
scipy\
tqdm\
joblib

For the Circos plot generated in Fig. 3b, circos-0.69-6 was used.

## Installation guide

User will have to install R and Python3 with the specific version number stated above. RStudio is recommended for running the R codes. The Python libraries can be installed through the Python Package Installer pip3. No compilation is required for both R and Python codes and can be run directly.

For installation of Circos, please refer to circos.ca for the installation detail.

For all python codes, the arguments will be shown when executed. 
```
python3 edgeR_foldchange_plotting_2D.py

usage: edgeR_foldchange_plotting_2D.py [-h] [-c CLASSES] [-s SUBCLASS]
                                       [-e DEG] [-d DIR] [-o OUT] [-m MATRIX]

optional arguments:
  -h, --help            show this help message and exit
  -c CLASSES, --classes CLASSES
                        ESSENTIAL Classification
  -s SUBCLASS, --subclass SUBCLASS
                        ESSENTIAL Subclassification
  -e DEG, --deg DEG     ESSENTIAL DEG matrix from edgeR
  -d DIR, --dir DIR     ESSENTIAL EdgeR diff exp output directory
  -o OUT, --out OUT     ESSENTIAL Output file name
  -m MATRIX, --matrix MATRIX
                        TEST TMM matrix or any normalized matrix
```



## Demo

For circos plot, user will need to first install Circos. All essential data is included in Plots/Circos-plot-data and can be run as follow:
```
bin\circos -conf ./circos.conf
```
where bin\circos is the binary of circos where the user installed. The karyotype, ideogram and links files are all generated by circos-data-generation.py

For GO plots, the graphs can be generated by the data included in Plots/GO-plots with the script GO_plots.py


